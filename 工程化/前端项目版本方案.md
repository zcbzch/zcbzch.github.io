# 前端项目版本方案

[TOC]

## NPM 版本号规则

`major`.`minor`.`patch`-`preid`

`大版本`.`中版本`.`小版本`-`预发布号`

## NPM 版本标签 `dist-tag`

### `dist-tag` 列表

| 标签   | 涵义     | 说明                                          |
| ------ | -------- | --------------------------------------------- |
| demo   | demo版本 | 方案原型                                      |
| dev    | 开发版本 | 开发主版本，不需要主动打tag，默认同latest版本 |
| alpha  | α版本    | 内部交流版本，展现初期实现效果                |
| beta   | β版本    | 交付测试版本                                  |
| gamma  | γ版本    | 测试通过，提交安全测试，与发布版本相差无异    |
| stable | 稳定版本 | 正式发布版本，稳定版本                        |
| latest | 最新版本 | 默认tag                                       |

### 版本差异

|          | demo | `dev` | alpha | `beta` | gamma | `stable` |
| -------- | ---- | ----- | ----- | ------ | ----- | -------- |
| 原型     | √    | √     | √     | √      | √     | √        |
| 方案确定 |      | √     | √     | √      | √     | √        |
| 单元测试 |      |       | √     | √      | √     | √        |
| 功能完善 |      |       |       | √      | √     | √        |
| 团队测试 |      |       |       |        | √     | √        |
| 安全测试 |      |       |       |        |       | √        |

### 版本适用人群

| 人群       | demo | `dev` | alpha | `beta` | gamma | `stable` |
| ---------- | ---- | ----- | ----- | ------ | ----- | -------- |
| 开发       | √    | √     |       |        |       |          |
| 产品       |      |       | √     | √      | √     | √        |
| 测试       |      |       |       | √      |       |          |
| 安全实验室 |      |       |       |        | √     |          |
| 用户       |      |       |       |        |       | √        |

### 开发流程

#### 业务迭代开发

`dev` > `beta` > `stable` 

(开发) > (测试) > (发布)

> 业务迭代发布一般需要在1周内，开发流程需要尽可能的短且简洁。

#### 较长周期业务开发

`dev` > `alpha` > `beta` > `gamma` > `stable`

(开发) > (内部预览) > (测试) > (待发布，提交给安全实验室) > (正式发布)

> 类似与OSM平台的开发，开发周期较长，开发内容在较长一段时间内处于不透明状态。因此，需要有`alpha`版本来作为内部展示版本。功能完成后不会直接发布，因此需要设置为`gamma`版本

#### 技术调研

`demo` > `dev` > `beta` > `stable`

(各类方案demo) > (确认方案后正式开发) > (内部测试/审核版本) > (正式发布)

> 技术调研可能需要多种方案，多个demo，因此在正式开发前发布各个方案的`demo`版本。确立方案后进行开发直至功能完善发布`beta`版本，进行内部交流审核（技术交流会），通过后发布正式`stable`版本。

## NPM版本发布操作

### 首次发布

1. 开发代码
2. 确认`README.md`内容
3. 确认`package.json`信息（尤其是`name`和`version`）
4. `git add -A & git commit & git push`
5. `npm publish`

### 迭代更新 [`patch`|`minor`|`major`]

1. 开发代码
2. 确认`README.md`内容
3. `git add -A & git commit`
4. `npm version patch|minor|major`
5. 确认是否需要标记tag, `npm dist-tag <pkg>@<version> <tag>`
6. `npm push`